/*!
 *
 *  Web Starter Kit
 *  Copyright 2014 Google Inc. All rights reserved.
 *
 *  Licensed under the Apache License, Version 2.0 (the "License");
 *  you may not use this file except in compliance with the License.
 *  You may obtain a copy of the License at
 *
 *    https://www.apache.org/licenses/LICENSE-2.0
 *
 *  Unless required by applicable law or agreed to in writing, software
 *  distributed under the License is distributed on an "AS IS" BASIS,
 *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 *  See the License for the specific language governing permissions and
 *  limitations under the License
 *
 */
function changePlace(e){localStorage.setItem("place",e),location.reload()}function removePerson(e){0===$(".person.selected").length&&($(".pid-"+e).addClass("selected"),$(".dialog").addClass("open"),$(".dialog").data("pid",e),$(".dialog").data("type","remove_person"))}var ip="";!function(){"use strict";function e(){a.classList.remove("open"),i.classList.remove("open"),c.classList.remove("open")}function n(){a.classList.toggle("open"),i.classList.toggle("open"),c.classList.toggle("open"),c.classList.add("opened")}function o(){location.reload()}var t=document.querySelector.bind(document),c=t(".navdrawer-container"),a=document.body,i=t(".app-bar"),s=t(".menu"),r=t(".refresh"),l=t("main");l.addEventListener("click",e),s.addEventListener("click",n),r.addEventListener("click",o),$.get(ip+"/retrieve_places",function(e){$.each(e,function(e,n){$(".place-list").append('<div class="item" onclick="changePlace(\''+n+"');\">"+n+"</div>")})}),$(".navdrawer-container li").click(function(){$(this).find(".sub-menu").addClass("open")}),$(".submit-button").click(function(){var e=$("#place_name").val(),n=$("#num_counters").val();0===e.length||parseInt(n)<1||$.get(ip+"/add_place",{place:e,num_counters:n},function(n){console.log(n),localStorage.setItem("place",e),location.reload()})})}(),function(){"use strict";function e(){$.get(s+"/retrieve_queues",{place:l},function(e){$.each(e,function(e,n){$(".queue-container."+n.queue).append(t(n.person_id)),n.is_being_served&&($(".pid-"+n.person_id).addClass("processing"),$(".counter-container."+n.queue).addClass("processing"))})}).done(function(){n()})}function n(){$(".counter-container").click(function(){var e=$(this).attr("class").split(/\s+/),n=o(e);if(console.log(n),0===$(".queue-container."+n+" .person").length)return void console.log("error, there is no one in the queue!");var t=$(".queue-container."+n+" .person").first(),c=t.text(),a=$(this);$(this).hasClass("processing")?$.get(s+"/process_complete",{person_id:c},function(e){console.log(e)}).done(function(){t.remove(),a.removeClass("processing")}):$.get(s+"/process_person",{person_id:c},function(e){console.log(e)}).done(function(){t.addClass("processing"),a.addClass("processing")})}),$(".button-container").click(function(){var e=$(this).children().first();e.addClass("clicked"),setTimeout(function(){e.removeClass("clicked")},300);var n=$(this).attr("class").split(/\s+/),c=o(n),a="",i={queue_id:c,place:l};$.get(s+"/add_person",i,function(e){a=e.pid}).done(function(){$(".queue-container."+c).append(t(a))})}),$(".dialog .confirm").click(function(){var e=$(".dialog").data("pid"),n={person_id:e};$.get(s+"/delete_person",n,function(e){console.log(e)}).done(function(){$(".pid-"+e).remove(),$(".dialog").removeClass("open")})}),$(".dialog .cancel").click(function(){var e=$(".dialog").data("pid");$(".pid-"+e).removeClass("selected"),$(".dialog").removeClass("open")})}function o(e){var n="";return $.each(e,function(e,o){1==o.length&&(n=o)}),n}function t(e){return'<div class="person pid-'+e+'" onclick="removePerson('+e+')">'+e+"</div>"}function c(e){return'<div class="general-container counter-container '+e+'">              <div class="counter">'+e+"</div>            </div>"}function a(e){return'<div class="general-container queue-container '+e+'"></div>'}function i(e){return'<div class="general-container button-container '+e+'">               <div class="add-button"></div>             </div>'}var s="";null===localStorage.getItem("place")&&localStorage.setItem("place","matcha");var r,l=localStorage.getItem("place");$.get(s+"/retrieve_queue_info",{place:l},function(e){l=e.place,r=e.num_counters,$(".app-title .place-name").text(l);for(var n=65;65+r>n;n++){var o=String.fromCharCode(n);$(".counters").append(c(o)),$(".queues").append(a(o)),$(".add-buttons").append(i(o))}var t=100/r;$(".general-container").css({width:t+"%"})}).done(function(){e()})}();